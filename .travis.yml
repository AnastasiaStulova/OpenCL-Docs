dist: xenial

language: ruby

git:
  depth: 200

rvm:
  - 2.3.3

before_install:
  - sudo apt-get install -y libpango1.0-dev ghostscript fonts-lyx
  - gem install asciidoctor -v 1.5.8
  - gem install coderay -v 1.1.1
  - gem install ttfunk -v 1.5.1
  - gem install asciidoctor-pdf -v 1.5.0
  - MATHEMATICAL_SKIP_STRDUP=1 gem install asciidoctor-mathematical -v 0.2.2

script:
  - git describe --tags --dirty
  - make api c env ext cxx4opencl

deploy:
  provider: releases
  file_glob: true
  file:
    - out/pdf/*
    - out/html/
  skip_cleanup: true
  on:
    tags: true
  api_key:
    secure: DVehdUfu0dtS/EyoJ/EHmLEYqmm/njBGaaNDNDZea8RAK1JG0QrJi4U4iLuLTAvazlrzSBwBvfgewz5PeAVfbpPiqnMx1hpDCJ6IHQVkpxwT0W/Y8jcNnLJhFm6pXxKVd+XVraTPrbGMA9QXM1vatPDnHLyaEw6ecrM+zYOSA5RMvqgNDTW4aSpDDs3DxguIFO7IrPy7zE892pglPAOgIohS9yiqHkg026G4JRT5g6f3Dkv/alJrEAflbPa7bYnGUhZ9DVeKbk5hjwUX9lUKYxfbfROsOPwoTSzc5O68KcssPsi2wGf3pqshwRb04QE5X0r9HqNIT8e+Kr+bb71eFaut7dPwWMcqz+FCV9kTtOPw1SqNlYcFAeOgz23FIKjyJJMjaOjUDHc8wsEFmZ8ku2dNoV7A+Wa+OLnWH0MEAji0yAjgDqBZMXUgUxrJOSpSdmFLBNp7XWkuOnAdIC5ePHYGmaYfpFyRiWSO+Fh6/dYICRxpedB8Y7SPzuXXroKyJoCsw9Bt3aLL+GQk04Z+cTGNJ5KyDFgphGqRLYMI21SJ6sKQpR0nk77yMtwsYRRs+od+EAjHqL2O8uDdgfCzAQmJPRTKbfgusrDkRb5iK4Pc8b7KIThIzsCLseB8EG6hMydnV5Lo0vn5UBUE/DcJskf+56vkDOGzSUpJ1AZjXro=
